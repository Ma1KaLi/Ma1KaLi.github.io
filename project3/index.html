<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Project 3 — Stitching Photo Mosaics</title>
  <style>
    :root { --maxw: 980px; }
    body {
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      margin: 0; line-height: 1.6; color: #222; background: #fafafa;
    }
    header, main, footer { max-width: var(--maxw); margin: 0 auto; padding: 20px; }
    header h1 { margin: 0 0 6px; }
    header a { color: #0b5fff; text-decoration: none; }
    section {
      background: #fff; border: 1px solid #eee; border-radius: 14px;
      padding: 18px; margin: 18px 0 24px; box-shadow: 0 1px 3px rgba(0,0,0,.05);
    }
    h2 { margin: 0 0 12px; font-size: 1.25rem; }
    h3 { margin: 8px 0 8px; font-size: 1.1rem; }
    p { margin: 8px 0; }
    pre { background:#0f172a; color:#e5e7eb; padding:14px; border-radius:10px; overflow:auto; }
    code { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace; }
    .grid-2 { display:grid; grid-template-columns:repeat(2,minmax(0,1fr)); gap:12px; }
    .grid-4 { display:grid; grid-template-columns:repeat(4,minmax(0,1fr)); gap:12px; }
    @media (max-width: 900px) { .grid-4 { grid-template-columns:repeat(2,minmax(0,1fr)); } }
    @media (max-width: 720px) { .grid-2 { grid-template-columns:1fr; } }
    figure { margin:0; border:1px solid #eee; border-radius:12px; overflow:hidden; background:#fff; }
    figure img, figure video { display:block; width:100%; height:auto; }
    figcaption { font-size:.9rem; padding:10px 12px; background:#f6f7fb; border-top:1px solid #eee; }
    .answer { background:#f4fbf6; border:1px solid #d8f1df; border-radius:10px; padding:10px 12px; margin-top:10px; }
    .note { font-size:.92rem; color:#555; background:#fff7e6; border:1px solid #ffe2a8; border-radius:10px; padding:10px 12px; margin-top:10px; }
    footer { font-size:.9rem; color:#666; }
    .back { display:inline-block; margin-top:6px; }
    ul.tight { margin:8px 0; padding-left: 18px; }
    .grid-3 { display:grid; grid-template-columns:repeat(3,minmax(0,1fr)); gap:12px; }
  </style>
  <!-- MathJax for nicely typeset matrices/equations -->
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
  <header>
    <h1>Project 3 — Stitching Photo Mosaics</h1>
    <a class="back" href="../index.html">← Back to main portfolio</a>
  </header>

  <main>
    <section id="part-a">
      <h2>Part A: IMAGE WARPING and MOSAICING</h2>
      <section id="a1">
      <h3>A.1: Shoot the Pictures</h3>
        <p>
          Images can be related by many transformations. In this part we care about the
          <strong>perspective/projective</strong> case—the camera model that explains how a planar scene looks from
          slightly different viewpoints. You can think of translation/rotation/affine as simpler limits, while
          projective transforms cover the full perspective effects we see in photos.
        </p>
        <p>
          Intuitively, a projective warp remaps the image as if the camera were tilted or the plane were viewed from a
          new angle. A few useful facts:
        </p>
        <ul class="tight">
        <li>Straight lines remain straight, but parallel lines may meet at a vanishing point.</li>
        <li>Distances and their ratios are generally <em>not</em> preserved.</li>
        <li>There is no requirement that the origin maps to the origin.</li>
        <li>Composing two projective warps yields another projective warp.</li>
        <li>Algebraically, it is a change of coordinates in projective space using a 3×3 homography.</li>
        </ul>
        <p>
          Below are two example pairs shot on campus. For each pair, the <em>center of projection</em> is held fixed while the
          camera rotates, producing the desired projective relationship that we will use later for rectification and
          mosaicing.
        </p>

      <!-- Set 1 placeholders -->
      <div class="grid-2">
        <figure>
          <img src="media/WechatIMG115.jpg" alt="Scene 1 from a straight angle" loading="lazy">
          <figcaption>Scene 1 — Figure 1</figcaption>
        </figure>
        <figure>
          <img src="media/WechatIMG114.jpg" alt="Scene 1 from a rotated angle" loading="lazy">
          <figcaption>Scene 1 — Figure 2</figcaption>
        </figure>
      </div>

      <!-- Set 2 placeholders -->
      <div class="grid-2" style="margin-top:12px;">
        <figure>
          <img src="media/WechatIMG119.jpg" alt="Scene 2 from a straight angle" loading="lazy">
          <figcaption>Scene 2 — Figure 2</figcaption>
        </figure>
        <figure>
          <img src="media/WechatIMG118.jpg" alt="Scene 2 from a rotated angle" loading="lazy">
          <figcaption>Scene 2 — Figure 2</figcaption>
        </figure>
      </div>
      </section>

      <section id="a2">
        <h2>A.2: Recover Homographies</h2>
      
        <!-- 原图（两张） -->
        <div class="grid-2">
          <figure>
            <img src="WechatIMG115.jpg" alt="Image 1 (source)" />
            <figcaption>Image 1</figcaption>
          </figure>
          <figure>
            <img src="WechatIMG114.jpg" alt="Image 2 (target)" />
            <figcaption>Image 2</figcaption>
          </figure>
        </div>
      
        <!-- 对应点可视化 -->
        <figure style="margin-top:12px;">
          <img src="a2_preview.png" alt="Point correspondences visualized side-by-side" />
          <figcaption>Point correspondences visualized on the images.</figcaption>
        </figure>
      
        <!-- 描述与方程 -->
        <div class="note" style="margin-top:14px;">
          我们用点对应 \((x_i, y_i) \leftrightarrow (u_i, v_i)\) 来估计单应矩阵 \(H\)，使得
          \[
            \begin{bmatrix}\lambda u\\ \lambda v\\ \lambda\end{bmatrix} =
            \begin{bmatrix}
              h_1 & h_2 & h_3\\
              h_4 & h_5 & h_6\\
              h_7 & h_8 & 1
            \end{bmatrix}
            \begin{bmatrix}x\\ y\\ 1\end{bmatrix}.
          \]
          将齐次坐标消去后，对每一对匹配点可得到两条线性约束，把未知量
          \(\mathbf{h}=[h_1,h_2,h_3,h_4,h_5,h_6,h_7,h_8]^T\) 组织成线性系统
          \(A\mathbf{h}=\mathbf{b}\)（下式展示了前四对匹配点的行结构；更多点用最小二乘求解）：
          \[
            \begin{bmatrix}
              x_1 & y_1 & 1 & 0 & 0 & 0 & -u_1 x_1 & -u_1 y_1\\
              0 & 0 & 0 & x_1 & y_1 & 1 & -v_1 x_1 & -v_1 y_1\\[2pt]
              x_2 & y_2 & 1 & 0 & 0 & 0 & -u_2 x_2 & -u_2 y_2\\
              0 & 0 & 0 & x_2 & y_2 & 1 & -v_2 x_2 & -v_2 y_2\\[2pt]
              x_3 & y_3 & 1 & 0 & 0 & 0 & -u_3 x_3 & -u_3 y_3\\
              0 & 0 & 0 & x_3 & y_3 & 1 & -v_3 x_3 & -v_3 y_3\\[2pt]
              x_4 & y_4 & 1 & 0 & 0 & 0 & -u_4 x_4 & -u_4 y_4\\
              0 & 0 & 0 & x_4 & y_4 & 1 & -v_4 x_4 & -v_4 y_4
            \end{bmatrix}
            \begin{bmatrix}
              h_1\\h_2\\h_3\\h_4\\h_5\\h_6\\h_7\\h_8
            \end{bmatrix} =
            \begin{bmatrix}
              u_1\\v_1\\u_2\\v_2\\u_3\\v_3\\u_4\\v_4
            \end{bmatrix}.
          \]
          解得的 \(\hat{\mathbf{h}}\) 回填到
          \(
            H=
            \begin{bmatrix}
              h_1 & h_2 & h_3\\
              h_4 & h_5 & h_6\\
              h_7 & h_8 & 1
            \end{bmatrix}
          \)，再按 \(H_{33}=1\) 归一化。
        </div>
      
        <!-- 恢复的 H 矩阵 -->
        <h3 style="margin-top:14px;">Recovered Homography \(H\)</h3>
        <pre><code>[[ 5.88791765e-01  1.63905192e-02  1.89669153e+03]
      [-3.18000604e-01  8.60996283e-01  3.23268751e+02]
      [-9.53829001e-05 -5.88331546e-06  1.00000000e+00]]</code></pre>
      </section>

    </section>

  </main>

  <footer>
    © <script>document.write(new Date().getFullYear());</script> Project 3. All media courtesy of the author.
  </footer>
</body>
</html>

